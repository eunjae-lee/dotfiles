name: "Nodejs Asdf"
description: "Set up Node.js and related tools via asdf"

# Configuration that gets merged into config.yml
config:
  homebrew:
    packages:
      - asdf
      - gnupg
  
  asdf:
    plugins:
      - nodejs
      - alias
      - pnpm
      - ni
    
    nodejs_versions:
      - latest
    
    nodejs_aliases:
      - name: "20"
        version: "20.10.0"
      - name: "18"
        version: "18.20.4"

# Commands to execute
up:
  - name: "Install asdf"
    command: "brew install asdf"
    
  - name: "Install gnupg for Node.js"
    command: "brew install gnupg"
    
  - name: "Add Node.js plugin"
    command: "asdf plugin add nodejs https://github.com/asdf-vm/asdf-nodejs.git || true"
    
  - name: "Install latest Node.js"
    command: "asdf install nodejs latest && asdf global nodejs latest"
    
  - name: "Add alias plugin"
    command: "asdf plugin add alias https://github.com/andrewthauer/asdf-alias.git || true"
    
  - name: "Set Node.js aliases"
    command: "asdf alias nodejs 20 20.10.0 && asdf alias nodejs 18 18.20.4"
    
  - name: "Add pnpm plugin"
    command: "asdf plugin-add pnpm || true"
    
  - name: "Install pnpm"
    command: "asdf install pnpm latest && asdf global pnpm latest"
    
  - name: "Add ni plugin"
    command: "asdf plugin add ni https://github.com/CanRau/asdf-ni.git || true"
    
  - name: "Install ni"
    command: "asdf install ni latest && asdf global ni latest"
